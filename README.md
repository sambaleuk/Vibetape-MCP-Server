# VibeTape MCP v0.2 (Hybrid Active Memory)

> **VibeTape** ‚Äî "record the vibe of your build". Un serveur MCP qui capture les moments cl√©s de votre d√©veloppement (victoires, √©checs, d√©cisions), g√©n√®re des cartes RETEX compactes, et permet √† votre IA IDE de les rappeler/rechercher/rejouer √† la demande.

## üÜï Nouveaut√©s v0.2

- **Relations entre moments** : Liez vos moments (`causes`, `solves`, `relates`)
- **Commentaires** : Ajoutez des commentaires sur les moments
- **Recherche avanc√©e** : Filtres combin√©s (tags, dates, regex, s√©mantique)
- **Analyses** : Stats, patterns r√©currents, graphiques de relations
- **Team Vault** : Partage optionnel avec l'√©quipe via fichier Git
- **Export** : JSON et Markdown complets

## üéØ Qu'est-ce que c'est ?

**VibeTape** est un serveur MCP (Model Context Protocol) qui expose :

- **Outils** : `mark_moment`, `list_moments`, `search_moments`, `make_retex`, `export_timeline`
- **Ressources** : `moment://{id}`, `timeline://{day}`, `retex://{id}`
- **Prompts** : `induce-retex`, `commit-msg`

**Stockage local** : Store JSON dans `~/.vibetape/state.json` (simple & portable). Embeddings OpenAI optionnels (fallback vers TF-IDF cosine).

**S√©curit√©** : lecture seule sur les fichiers projet (pas d'ex√©cution shell), √©crit uniquement dans `~/.vibetape/`.

## üöÄ Installation et configuration

### 1. Cloner et installer les d√©pendances

```bash
git clone <votre-repo>
cd vibetape-mcp
npm install
```

### 2. Configuration de l'environnement

Copiez `.env.example` vers `.env` et configurez :

```bash
cp .env.example .env
```

√âditez `.env` :
```env
OPENAI_API_KEY=sk-your-openai-key-here
# Optionnel : o√π stocker l'√©tat
VIBETAPE_HOME=~/.vibetape
```

> **Note** : La cl√© OpenAI est optionnelle. Sans elle, VibeTape utilisera un fallback TF-IDF pour les embeddings.

### 3. Lancer le serveur

```bash
# Mode d√©veloppement
npm run dev

# Ou compiler et lancer
npm run build
npm start
```

## üîå Connexion avec Claude Desktop (macOS)

√âditez `~/Library/Application Support/Claude/claude_desktop_config.json` :

```json
{
  "mcpServers": {
    "vibetape": {
      "command": "node",
      "args": ["/Users/birahimmbow/Projets/VibeTapeMCP/dist/server.js"],
      "cwd": "/Users/birahimmbow/Projets/VibeTapeMCP",
      "env": { 
        "OPENAI_API_KEY": "votre-cl√©-openai-ici"
      }
    }
  }
}
```

Red√©marrez Claude Desktop ‚Üí ouvrez l'ic√¥ne marteau ‚Üí vous verrez les outils VibeTape.

## üîå Connexion avec Claude Code (VS Code)

### 1. Installer l'extension Claude Code

Installez l'extension [Claude Code](https://marketplace.visualstudio.com/items?itemName=Anthropic.claude-code) depuis le marketplace VS Code.

### 2. Configuration MCP

Ouvrez les param√®tres VS Code (`Cmd+,` sur macOS ou `Ctrl+,` sur Windows/Linux) et cherchez "claude".

Ou √©ditez directement votre `settings.json` :

```json
{
  "claude.mcpServers": {
    "vibetape": {
      "command": "node",
      "args": ["/Users/birahimmbow/Projets/VibeTapeMCP/dist/server.js"],
      "cwd": "/Users/birahimmbow/Projets/VibeTapeMCP",
      "env": {
        "OPENAI_API_KEY": "votre-cl√©-openai-ici"
      }
    }
  }
}
```

### 3. Utilisation dans VS Code

- Ouvrez la palette de commandes (`Cmd+Shift+P` / `Ctrl+Shift+P`)
- Tapez "Claude" pour voir les commandes disponibles
- Ou utilisez le panneau Claude dans la barre lat√©rale
- Les outils VibeTape seront automatiquement disponibles dans vos conversations

## üîå Autres clients MCP

VibeTape fonctionne avec n'importe quel client MCP compatible. La configuration de base est toujours :

```json
{
  "command": "node",
  "args": ["/chemin/absolu/vers/VibeTapeMCP/dist/server.js"],
  "cwd": "/chemin/absolu/vers/VibeTapeMCP",
  "env": {
    "OPENAI_API_KEY": "votre-cl√©-openai-ici"
  }
}
```

## üí° Conseils de configuration

### Chemin absolu requis
‚ö†Ô∏è **Important** : Utilisez toujours des **chemins absolus** dans la configuration. Les chemins relatifs ne fonctionnent pas de mani√®re fiable avec les clients MCP.

### Variable d'environnement optionnelle
Si vous pr√©f√©rez ne pas mettre votre cl√© OpenAI dans la config, cr√©ez un fichier `.env` dans le dossier du projet :

```bash
# Dans /Users/birahimmbow/Projets/VibeTapeMCP/.env
OPENAI_API_KEY=votre-cl√©-openai-ici
VIBETAPE_HOME=~/.vibetape
```

Puis utilisez cette configuration simplifi√©e :
```json
{
  "command": "node",
  "args": ["/Users/birahimmbow/Projets/VibeTapeMCP/dist/server.js"],
  "cwd": "/Users/birahimmbow/Projets/VibeTapeMCP"
}
```

### Fallback sans OpenAI
VibeTape fonctionne m√™me **sans cl√© OpenAI** ! Il utilisera alors :
- ‚úÖ Embeddings TF-IDF pour la recherche s√©mantique
- ‚ùå Pas de g√©n√©ration de cartes RETEX (outil `make_retex` indisponible)

## üìñ Utilisation typique

### 1. Marquer un moment

Pendant votre d√©veloppement, quand quelque chose d'important se passe :

```
Outil: mark_moment
{
  "title": "API cache Redis impl√©ment√©e avec succ√®s",
  "kind": "win",
  "tags": ["api", "cache", "redis"],
  "details": "R√©duction du temps de r√©ponse de 200ms √† 50ms"
}
```

### 2. Rechercher des moments similaires

Plus tard, face √† un probl√®me similaire :

```
Outil: search_moments
{
  "query": "probl√®me performance API",
  "k": 5
}
```

### 3. G√©n√©rer une carte RETEX

Pour cr√©er une carte de retour d'exp√©rience prescriptive :

```
Outil: make_retex
{
  "momentId": "01HXX..."
}
```

### 4. Exporter la timeline du jour

Pour partager votre journ√©e :

```
Outil: export_timeline
{
  "day": "2025-01-15"
}
```

## üõ†Ô∏è Outils disponibles

### Outils v0.1 (Base)

#### `mark_moment`
Capture un moment cl√© avec snapshot de contexte s√©curis√©.

**Param√®tres :**
- `title` (requis) : Titre du moment
- `kind` (requis) : Type - `'win'|'fail'|'decision'|'note'`
- `tags` (optionnel) : Tags pour cat√©gorisation
- `details` (optionnel) : D√©tails suppl√©mentaires
- `cwd` (optionnel) : R√©pertoire de travail

### `list_moments`
Liste les moments r√©cents.

**Param√®tres :**
- `limit` (optionnel) : Nombre de moments √† retourner (d√©faut: 10)

### `search_moments`
Recherche s√©mantique dans les moments.

**Param√®tres :**
- `query` (requis) : Requ√™te de recherche
- `k` (optionnel) : Nombre de r√©sultats (d√©faut: 5)

### `make_retex`
G√©n√®re une carte RETEX √† partir d'un moment.

**Param√®tres :**
- `momentId` (requis) : ID du moment source

#### `export_timeline`
Exporte une timeline Markdown pour un jour donn√©.

**Param√®tres :**
- `day` (requis) : Jour au format YYYY-MM-DD

### üÜï Nouveaux outils v0.2

#### `link_moments`
Cr√©e une relation entre deux moments.

**Param√®tres :**
- `from` (requis) : ID du moment source
- `to` (requis) : ID du moment cible  
- `kind` (requis) : Type de relation - `'causes'|'solves'|'relates'`
- `note` (optionnel) : Note sur la relation

#### `comment_moment`
Ajoute un commentaire √† un moment.

**Param√®tres :**
- `id` (requis) : ID du moment √† commenter
- `text` (requis) : Texte du commentaire
- `author` (optionnel) : Auteur du commentaire

#### `search_moments_advanced`
Recherche avanc√©e combinant filtres et s√©mantique.

**Param√®tres :**
- `query` (optionnel) : Requ√™te s√©mantique
- `tags` (optionnel) : Tags requis
- `kinds` (optionnel) : Types de moments
- `from` (optionnel) : Date de d√©but (ISO)
- `to` (optionnel) : Date de fin (ISO)
- `regex` (optionnel) : Pattern regex pour le texte
- `k` (optionnel) : Nombre max de r√©sultats

#### `stats_overview`
Statistiques et tendances.

**Param√®tres :**
- `window` (optionnel) : Fen√™tre temporelle - `'7d'|'30d'|'all'`

#### `recurrent_patterns`
Identifie les patterns r√©currents dans les titres.

**Param√®tres :** Aucun

#### `export_json` / `export_md`
Exporte tout l'√©tat en JSON ou Markdown.

**Param√®tres :**
- `q` (optionnel) : Param√®tre de requ√™te

## üìã Ressources disponibles

### `moment://{id}`
Moment captur√© au format JSON.

### `timeline://{day}`
Timeline Markdown d'un jour sp√©cifique.

### `retex://{id}`
Carte RETEX prescriptive au format JSON.

### üÜï Nouvelles ressources v0.2

#### `graph://{id}`
Graphique de relations pour un moment (n≈ìuds + ar√™tes JSON).

#### `export://json?{q}`
Export JSON complet de l'√©tat.

#### `export://md?{q}`
Export Markdown complet des moments.

## üîó Team Vault (Collaboration)

Pour partager VibeTape avec votre √©quipe, configurez :

```bash
# Dans votre .env
VIBETAPE_TEAM_DIR=~/votre/repo/equipe
```

VibeTape cr√©era automatiquement `team_state.json` dans ce dossier. Commitez/pushez ce fichier dans un repo Git priv√© pour partager :
- Moments de l'√©quipe
- Relations entre moments  
- Commentaires collaboratifs
- Recherche partag√©e

## üéØ Prompts disponibles

### `induce-retex`
Template r√©utilisable pour l'induction de r√®gles RETEX.

### `commit-msg`
Aide pour cr√©er des messages de commit conventionnels.

## üîí S√©curit√© et port√©e

- **Aucune √©criture shell, aucun appel r√©seau** sauf embeddings OpenAI optionnels
- √âcrit uniquement dans `~/.vibetape/state.json`
- Lecture seule sur les fichiers du projet
- Capture de contexte git s√©curis√©e (pas d'ex√©cution de tests)

## üóÇÔ∏è Structure des donn√©es

### Moment
```typescript
type Moment = {
  id: string;
  ts: number;
  title: string;
  kind: 'win'|'fail'|'decision'|'note';
  tags: string[];
  details?: string;
  cwd?: string;
  git?: { branch?: string; sha?: string };
  snapshot?: { diff?: string; tests?: string; deps?: string };
  text: string; // texte searchable concat√©n√©
  embedding?: number[]; // optionnel
  relations?: Relation[]; // üÜï relations vers autres moments
  comments?: Comment[]; // üÜï commentaires
};

// üÜï Nouveaux types v0.2
type Relation = {
  to: string;
  kind: 'causes'|'solves'|'relates';
  note?: string;
};

type Comment = {
  ts: number;
  author?: string;
  text: string;
};
```

### Carte RETEX
```typescript
type RetexCard = {
  id: string;
  momentId: string;
  title: string;
  type: 'pitfall'|'pattern'|'decision';
  rule_short: string;
  bullets: [string, string, string]; // Situation, Action, R√©sultat
  dont?: string;
  tags: string[];
};
```

## üöß Roadmap (post-MVP)

- SQLite + HNSW pour recherche s√©mantique scalable
- Hooks automatiques : snippet Git post-commit pour appeler `mark_moment`
- Fusion de conflits/moments ‚Üí r√®gle g√©n√©ralis√©e (RETEX Flash merge)
- Export PR/CHANGELOG directement comme ressources

## üéûÔ∏è Philosophie

VibeTape vous donne une interface MCP simple et √©l√©gante pour la **M√©moire Active Hybride** pendant le codage. Branchez-le dans Claude Desktop / Claude Code et commencez √† enregistrer l'ambiance de votre build.

---

**C'est tout !** VibeTape capture l'essence de votre processus de d√©veloppement. üéûÔ∏è‚ú®
